{"ast":null,"code":"// src/app/core/interceptors/loading.interceptor.spec.ts\nimport { TestBed } from '@angular/core/testing';\nimport { LoadingInterceptor } from './loading.interceptor';\nimport { HTTP_INTERCEPTORS, HttpClient } from '@angular/common/http';\nimport { provideHttpClientTesting, HttpTestingController } from '@angular/common/http/testing';\ndescribe('LoadingInterceptor', () => {\n  let interceptor;\n  let http;\n  let httpMock;\n  beforeEach(() => {\n    TestBed.configureTestingModule({\n      providers: [\n      // Angular 16+ -> provideHttpClientTesting() da HttpTestingController\n      provideHttpClientTesting(),\n      // Registramos el interceptor\n      {\n        provide: HTTP_INTERCEPTORS,\n        useClass: LoadingInterceptor,\n        multi: true\n      }]\n    });\n    interceptor = TestBed.inject(LoadingInterceptor);\n    http = TestBed.inject(HttpClient);\n    httpMock = TestBed.inject(HttpTestingController);\n  });\n  afterEach(() => {\n    httpMock.verify();\n  });\n  it('should toggle isLoading$ during request', () => {\n    let currentLoading = false;\n    // Suscribimos al observable isLoading$\n    const sub = interceptor.isLoading$.subscribe(val => {\n      currentLoading = val;\n    });\n    // Al inicio, isLoading$ = false\n    expect(currentLoading).toBeFalse();\n    // Disparamos una petici贸n GET\n    http.get('/api/test').subscribe();\n    const req = httpMock.expectOne('/api/test');\n    expect(req.request.method).toBe('GET');\n    // isLoading$ se activa\n    expect(currentLoading).toBeTrue();\n    // Cerramos la petici贸n\n    req.flush({});\n    // Tras finalizar, isLoading$ vuelve a false\n    expect(currentLoading).toBeFalse();\n    sub.unsubscribe();\n  });\n});","map":{"version":3,"names":["TestBed","LoadingInterceptor","HTTP_INTERCEPTORS","HttpClient","provideHttpClientTesting","HttpTestingController","describe","interceptor","http","httpMock","beforeEach","configureTestingModule","providers","provide","useClass","multi","inject","afterEach","verify","it","currentLoading","sub","isLoading$","subscribe","val","expect","toBeFalse","get","req","expectOne","request","method","toBe","toBeTrue","flush","unsubscribe"],"sources":["/Users/naranjax/app-heroes/src/app/core/interceptors/loading.interceptor.spec.ts"],"sourcesContent":["// src/app/core/interceptors/loading.interceptor.spec.ts\nimport { TestBed } from '@angular/core/testing';\nimport { LoadingInterceptor } from './loading.interceptor';\nimport { HTTP_INTERCEPTORS, HttpClient } from '@angular/common/http';\nimport { provideHttpClientTesting, HttpTestingController } from '@angular/common/http/testing';\n\ndescribe('LoadingInterceptor', () => {\n  let interceptor: LoadingInterceptor;\n  let http: HttpClient;\n  let httpMock: HttpTestingController;\n\n  beforeEach(() => {\n    TestBed.configureTestingModule({\n      providers: [\n        // Angular 16+ -> provideHttpClientTesting() da HttpTestingController\n        provideHttpClientTesting(),\n        // Registramos el interceptor\n        { provide: HTTP_INTERCEPTORS, useClass: LoadingInterceptor, multi: true }\n      ]\n    });\n\n    interceptor = TestBed.inject(LoadingInterceptor);\n    http = TestBed.inject(HttpClient);\n    httpMock = TestBed.inject(HttpTestingController);\n  });\n\n  afterEach(() => {\n    httpMock.verify();\n  });\n\n  it('should toggle isLoading$ during request', () => {\n    let currentLoading = false;\n\n    // Suscribimos al observable isLoading$\n    const sub = interceptor.isLoading$.subscribe(val => {\n      currentLoading = val;\n    });\n\n    // Al inicio, isLoading$ = false\n    expect(currentLoading).toBeFalse();\n\n    // Disparamos una petici贸n GET\n    http.get('/api/test').subscribe();\n    const req = httpMock.expectOne('/api/test');\n    expect(req.request.method).toBe('GET');\n\n    // isLoading$ se activa\n    expect(currentLoading).toBeTrue();\n\n    // Cerramos la petici贸n\n    req.flush({});\n    // Tras finalizar, isLoading$ vuelve a false\n    expect(currentLoading).toBeFalse();\n\n    sub.unsubscribe();\n  });\n});\n"],"mappings":"AAAA;AACA,SAASA,OAAO,QAAQ,uBAAuB;AAC/C,SAASC,kBAAkB,QAAQ,uBAAuB;AAC1D,SAASC,iBAAiB,EAAEC,UAAU,QAAQ,sBAAsB;AACpE,SAASC,wBAAwB,EAAEC,qBAAqB,QAAQ,8BAA8B;AAE9FC,QAAQ,CAAC,oBAAoB,EAAE,MAAK;EAClC,IAAIC,WAA+B;EACnC,IAAIC,IAAgB;EACpB,IAAIC,QAA+B;EAEnCC,UAAU,CAAC,MAAK;IACdV,OAAO,CAACW,sBAAsB,CAAC;MAC7BC,SAAS,EAAE;MACT;MACAR,wBAAwB,EAAE;MAC1B;MACA;QAAES,OAAO,EAAEX,iBAAiB;QAAEY,QAAQ,EAAEb,kBAAkB;QAAEc,KAAK,EAAE;MAAI,CAAE;KAE5E,CAAC;IAEFR,WAAW,GAAGP,OAAO,CAACgB,MAAM,CAACf,kBAAkB,CAAC;IAChDO,IAAI,GAAGR,OAAO,CAACgB,MAAM,CAACb,UAAU,CAAC;IACjCM,QAAQ,GAAGT,OAAO,CAACgB,MAAM,CAACX,qBAAqB,CAAC;EAClD,CAAC,CAAC;EAEFY,SAAS,CAAC,MAAK;IACbR,QAAQ,CAACS,MAAM,EAAE;EACnB,CAAC,CAAC;EAEFC,EAAE,CAAC,yCAAyC,EAAE,MAAK;IACjD,IAAIC,cAAc,GAAG,KAAK;IAE1B;IACA,MAAMC,GAAG,GAAGd,WAAW,CAACe,UAAU,CAACC,SAAS,CAACC,GAAG,IAAG;MACjDJ,cAAc,GAAGI,GAAG;IACtB,CAAC,CAAC;IAEF;IACAC,MAAM,CAACL,cAAc,CAAC,CAACM,SAAS,EAAE;IAElC;IACAlB,IAAI,CAACmB,GAAG,CAAC,WAAW,CAAC,CAACJ,SAAS,EAAE;IACjC,MAAMK,GAAG,GAAGnB,QAAQ,CAACoB,SAAS,CAAC,WAAW,CAAC;IAC3CJ,MAAM,CAACG,GAAG,CAACE,OAAO,CAACC,MAAM,CAAC,CAACC,IAAI,CAAC,KAAK,CAAC;IAEtC;IACAP,MAAM,CAACL,cAAc,CAAC,CAACa,QAAQ,EAAE;IAEjC;IACAL,GAAG,CAACM,KAAK,CAAC,EAAE,CAAC;IACb;IACAT,MAAM,CAACL,cAAc,CAAC,CAACM,SAAS,EAAE;IAElCL,GAAG,CAACc,WAAW,EAAE;EACnB,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}